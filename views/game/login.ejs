<%- include ('../header') %>

<main>
  <h1>ようこそ！</h1>
  <p class="announce">パスワードは半角英数字 4 文字以上 でお願いします！<br />ここはログイン画面　兼　登録画面です。</p>
  <div id="container">
    <p>お名前を入力してください。</p>
    <form class="form" action="/login" method="post">
      <div>
        <label>ユーザーID：</label>
        <input class="text" type="text" name="username" value=""/>
      </div>
      <div>
        <!-- <label>パスワード：</label> -->
        <input class="text" type="hidden" name="password" value="0000" />
      </div>
      <div>
        <input class="btn" type="submit" value="ログイン" />
      </div>
      <input type="hidden" name="_csrf" value="<%= csrftoken %>">
    </form>



    <!-- <form id="register">
    <label for="name">名前：</label>
    <input type="text" id="name">
    <input type="submit" value="登録する">
  </form>
  <p id="error"></p>
</div>
<script src='https://code.jquery.com/jquery-3.5.1.slim.min.js'></script>
<script src="/socket.io/socket.io.js"></script>
<script>
  $(function () {
    let socketIO = io.connect();
    // emit: イベントを発信している
    // on: イベントを待ち受けている
    $('#register').submit(function (e) {
      e.preventDefault();
      socketIO.emit('register', {
        name: $('#name').val()
      });
    });
    socketIO.on('register_result', function (data) {
      if (data.bool) {
        $('#container').append($('<p>').text('ようこそ' + data.id + ' : ' + data.name + 'さん！'));
        $('#container').append($('<a>').attr({href: '/chat'}).text('入室'));
      } else {
        $('#error').text('その名前は、既に使われています！');
      }
    });
  });
</script> -->

</main>

<%- include ('../footer') %>